package org.who.ddccverifier.verify

import org.junit.Test

import org.junit.Assert.*
import org.who.ddccverifier.trust.pathcheck.PCFTrustRegistry
import org.who.ddccverifier.verify.QRDecoder
import org.who.ddccverifier.verify.divoc.DivocVerifier


class QRVerifyPrivateTest: BaseTest() {

    @Test
    fun verifyDIVOCIndia() {
        val qr1 = "B64:UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAQAAAAY2VydGlmaWNhdGUuanNvboxUXXOiShD9K1Q/EwOIirzc64qJ+IWKGOOtrdQIA4ziDJkZ/Er532+Bu8nm1u7efaT79Ommz5l+g79DRiU+SbD/gVTKXNj398fjsXas1xhP7g1Nt+5DjiNMJUGZuD/ooL4DQ3YktJawQ43QzygUhoQiSRgtK76qIM85LnssMScxQZsMd9/xoMKUMxZ78fKj7of0VxU+yP1is8WhBPvtGydMMReMggokAhsiEtkOJwdCE2VEQkwFtsd9XVcMTW9omqGZZhNU4Dh2S3jdbNXrrZZpWZpe10AFivYlqY/2vIiilCh+ilJQoUgrelAhwTTCHGx4wHuUYVABJWWJUa/Ky+FRRuQZbHBpRFA5GooijoUopxaSYyw73wMl46eQcYtFREhOyh8tv8Ib3wfTHCeE0U+hLiuo5FXbCaiQMyFR1mURBtvUda1uXa8qECGKavifagg3AKIhdpCsfkoz9DvNujOshda0NcOuWzXDaqxBBXwgEaZhKevbbfc/5bx5Ad+3rXpLbzS0VrO0UIxxtEHhLuDZrwr/+lxBaMz+HB1iLklMQiRxpfPn7LsbP/xWumyDZJiCDaZu6Gtdb4AK36YHG7re0vX7bm/kgAp7RIsYhbLg1TJ9zIu94lIhiSwkVlisVNKXOv5qj61a27KqPcYxDiU5YF8iLj9hf8wGVJLsv9mICQy2roJkEmUOE1iAbahwqJ5ZOdvbd0cPOs8dZdEZf+kNO3O4qhCjkNx8+o6ZjrvKVBlyIlKKlD4TOVGGTKa8iH5vYkPpTAadyVNvpEznHb/fmSwU3+sq08BR5l7HUabBpPf/Tp8WFP/W7WOUIo5EKjn6I+MDXK/XrypQRhccURFjXt4esEHyomyVl4fnh2MyF8gnCUWlsuXxg+r2IImjnz+GUsDbssPKRmMsU/b9DpFvHqiaTAueV2oBEqJ05ztYhe2xXCI+D9LNY0g8MpgFF1efEFe4e9eYdN3mev8gQiMQ7n5yRqsZ8TJBnrfPmpvp7VotwEec0h1fPBfTeWim4/XzAjdyYs7zV4u3lyzxtnncpqnMfI/Fx+2X3ta507Ze32iHfPnQIGjOnNZg7ybOduWR4evpbuNfBrM5T7Rs5Gfa7DHwVvra2DU8ft7PmsYjp4HZfjyZl/3DE+vVl9ZmJFa707LXdVt+OzfW2WVAzafli9PmjO3ujq1ztDuijtGvu+3gdBwmyc61dvIwHvVf8umjiC4vL9wI1uE0tlbxYojjizl/6mjmoU9Oo4sT0HBYCNcJ6eS03rQtH/OGnDabTndUf0zWKPOPLTZrFPtWLJxVQ6RNY7yajfIVG6RjsXOH5uuoN354ipvB0kw0s/Wa4uHjIl8bPXe0Ph+8VuoFz35Mm6ExpsN5B67XfwMAAP//UEsHCMRIegwQBAAAIQcAAFBLAQIUABQACAAIAAAAAADESHoMEAQAACEHAAAQAAAAAAAAAAAAAAAAAAAAAABjZXJ0aWZpY2F0ZS5qc29uUEsFBgAAAAABAAEAPgAAAE4EAAAAAA=="
        val verified = DivocVerifier(registry).unpackAndVerify(qr1)

        assertNotNull(verified)
        assertEquals(QRDecoder.Status.VERIFIED, verified.status)
    }

    @Test
    fun verifyDIVOCPH1() {
        val qr1 = "B64:UEsDBAoAAAAIAId5K1NwbbOFZAMAACoFAAAQAAAAY2VydGlmaWNhdGUuanNvbnWSbW+qShDHvwrhdVEWFcFXlyJVrIKKWvTmxqywyAoCh+XRpt/97lpP25PcmxjDzPxnZuc3887/5aVJgZqCH/3Nh0WRkVG3W9d1p+510vzclUSgdL0c+SgpMIxJtwL805fQx1XqdbI89bsV9DycoD+1dx8scJqwvH+e+KLNEOu0QzkOMDzFSP/S07rLPE0DO9h95/0I0/Tv4k55uiCPvvr9UZNfopykCS2CfWpZGv3KUWAyYyiBvkrtBF6Zcqbpq60xNy2D0yz6N7G5tbawLY5KCGqo4sVYaHODmn56oiZQlaEgDgWg8B+0PiElylnH6Zwb21P+0wUTD41hwRpIogQEURUA2IDBSJRHvV5HlMGBKlGF6QQeg/D++dL/ZynL/cFAUlVG3EN5QYl5tMF9pJ+xL6jf2BisEyy8kI3LniPKotSnWlo/C9sYNpjQkG7vzLEAVO7R8Ymj+V6BK9rG5yqcl4TmPIJMn+ZpAmkf6r3CpAyouMzvMBycpNU94P+EoAhibyOCkcR+HQDuEPyUUIVEX54WMB5Ti9xNWg7HuGjZVh+7cjTT2nBze2s63NYyd8baMTd7bkHdnK4tlluH1oO+nyNCWNrjU0/LpMjbzyXxHx8flEeSJpscJiRAOTs8GivyEn0ySYMfl7Qm0MFnCpKOxu6fvx8eQ/Lfu2UjVfeD9u7wF6gIU6b1sT/KQjpSllF+5HerZZlndwI8JITt9Svlib/UbC+onYWniYdtPFttbyawsEnMqylZuikfri/Ek7bUtlrorrAdE7y/7EUzBmqns5E8T1b2YS1Hg/6LursegCsq3spTfKfMjI1JZsNp6z8voLKp2vMqDfsqrn4NDHMJbg31vEUkkcxmawT2i3ibHBO4fFs8u2kSbW9xc1i2mbbun+BYyPRYEBrp0t5Ac4na/TDbW/Vqe5zU0xKaPfN1N4tVx86uu2ldAAJRZYjAVeYDP5n0inilYVy+Ckc9k23B8Vqh3ElH94rluYoPUTrRj3PND6Z9rZ6NX2PJ6J+1mZGdTvJlER1jDc1mUv52iXb1cxQNkBO9vmIZ5YYti8nKiwZ7N9qQsCBKPNOURuiJajCe47nrhsC95aF+2bvn83hsNfpat9zLOjg8v9ilvJjfNmajrlTpOj6cQr0QbOgOV/SC/gVQSwECFAAKAAAACACHeStTcG2zhWQDAAAqBQAAEAAAAAAAAAAAAAAAAAAAAAAAY2VydGlmaWNhdGUuanNvblBLBQYAAAAAAQABAD4AAACSAwAAAAA="
        val verified = DivocVerifier(registry).unpackAndVerify(qr1)

        assertNotNull(verified)
        assertEquals(QRDecoder.Status.VERIFIED, verified.status)
    }

    @Test
    fun verifyDIVOCPH2() {
        val qr1 = "B64:UEsDBAoAAAAIALtpKVNhSZuJdAMAAEMFAAAQAAAAY2VydGlmaWNhdGUuanNvbnVTW2+zOBD9K4inXalJMOT+tARyISGQENI2fPpUGTCJE4Kp7VxI1f++dtptu9Ku5AfGPnNmzpnhTf0rIQVHV672f6k7zkvWbzQul0v9YtQJ3TZ0DXQbCUUpKjiGOWucgfrwBUzxmST1kpK0cYZJggv0b+z9DnJMCpn3+0HlVYlkpUdEcYZhnCPrCy94F5SQzM8ev/N+PIv0b/LVKd6jRHT99smpLhBlpBAkOBWRZ4ovijJHBgbodroiLuBRIk13FAxtxR66fuB4vjIKTC9aD11TERiGrgIyN92hCFISiwD0OnpNa9c0oL4LesZOiMqCE1ex/Yn6cQWLBNmQS35d00FN64kTAqMvTgvUQacZCSQ6YyEgkR68fTT6/1Z2QavXBKAnO08Q5cKwRBS4K/r59uXpt2vSqxjyZCe7AZrW0gVOcJe7KodXzMS15T86dg30lM9qD0pBihpFZS6r4GKrnDGFuXIWLhMq0j9xMnVnpv4V1FbKL4oScoxF1YL/Vv4wGacwQgVK4J8i4wiLUwYTfqJ3v368Smt/etWtaUaogb4uTx0AEN3NZwKhC4GEw9wWEbuHghLnmFdy9p8TtczQDOamJ0Y5HNr+XFmYwUxQwDSliDGJ/Py0yKngtPoYn/r+/i6cEsJDCguWISo3UrxxekIfjpHsx4oFDK7wVlgsFMkfQ71vpBCS/vfUpYrzfdOT+1jmiO+IxKY47Zc7oaIshaXsn1KLEy3volXImJz4V8qDur/IqaFquovHCfbxdLm+OcDDDnOOju5ZTjs6jliir0XsVfB5if2c4c1+ozk56NXrm2u6mBxDtlnV1vl6NdrH2/HKGixfM/g8M2a3RxjMo/EhbJ2zxG2GHRSfAjKE6+XM8KLwYJi4bYQTa1Tsq9C/VvHRSeieocSPLhkoyep8y27udeCjbTiZTe2j11xjJ1osOFmCazidgU0eolHnwC5RYHivMHi2XtJJe456zcNx9vpMBsdL69HadlAUnVYFRbOsuXgFBiMbuOiUQG8tW86pHYTOxOhMt9N978k4UGMKx9z0yC6OSdvYjK9gkT6F8/JGK3yOC7dpQ62MStd1ww1aYbG0290guLUnT7sATeIhbw4PLy0UV35c0qyaZKxHx0zLt0V7uz9UK3dkbwbd6PlidY2XmT3lLGnXcpRa+oDtS9MUG/Q3UEsBAhQACgAAAAgAu2kpU2FJm4l0AwAAQwUAABAAAAAAAAAAAAAAAAAAAAAAAGNlcnRpZmljYXRlLmpzb25QSwUGAAAAAAEAAQA+AAAAogMAAAAA"
        val verified = DivocVerifier(registry).unpackAndVerify(qr1)

        assertNotNull(verified)
        assertEquals(QRDecoder.Status.VERIFIED, verified.status)
    }

    @Test
    fun verifyDIVOCSrilanka() {
        val qr1 = "B64:UEsDBAoAAAAIAOyDOFPh0ixX+QMAAFoHAAAQAAAAY2VydGlmaWNhdGUuanNvbq1UW4+qSBD+K4Sn3WRQwMuoL7veRQVUhINuNpMWGmzFbgda1JnMfz/VOuM4yZmTbLIJD3RVfXX9ql7lvwNGOT5xufGPvOZ8nzWKxePxWDiWCiyNi7qq1YpBikNMOUFJVsw1+eFmGJKcBYUkDoJCzPJCsv1qioKAUMQJowL274PMz3ssAnk4JRFBqwS3b/bgdpIyFtmR94m7UwP807lzWG1wAEm/vvuUJzjNGAUnJIRXvaqXS6WSWvNAkuLI+CLMQUjRTsD6Tc+wJLM5nw+6P6ROV3KMsdcEfYxpiFOwMFGC4Y1iYa6XL1CRGkoIP4PISYk0RnSLRHAUhinOMpFXxlOMefNDIOtqvahLLcRRgmiIpBlD4YNkoi1LkOSwA19/vMDPF7AOaJCFBKREFC1L8Ayu4T+DznAMaYEo44jjT3mbHShPha1hgXTPQJ+0WSjq2RMaiL+3N2hclh0uFX8/XflqhWiAOyKGqErXFLWu6OW5Vm3olUa5VCjXH5dgiXMC0wrEwF+vU/ne8ZUquFjT6lpFrz3WAB9hHK5QsHXT5LfYv+5BhEbsPwECnHLgYgDlXEhyr7vR9ZOQgoYrxIO1mLxh2ZNBc2ZKf3jdmS21u+Pxn5IiiZ6o1ZamV+vg5L207+zBYofoIUIBP6SX9n9nFt53/FHRKnNVbVy+gqqql45HESwFybHDUcqvtqqi6WB7r3VhhZKbJ+2qDVkG3jUomgE9OvAC0uqQ/mVVRWKvHzvj0i1lRyoDZyBtct2Dm7bZaksmDqGjidSGbQXob/fiXTWGHmm/Yv6dXv+6Bbff/30Z3mDKlNF5imgW4VQcKtDz9CA87cWVurs8sww5JAZ6wPzEuZQvhwqihr/eDzGpa1eDC6VMzNcsvNQTNrKUJOKYNHZs/RFrckj3l+nIKMsEXW+YB3lzFD3E5+F61Q+ITYZT98XQLGJkxs7QrbZRXe56WaC78LbOyJ8SO8nIYrNQjUSrFwqtZmdEl/2Y79axs3PLMbL4We/7hqdZ59Ok99J7HulcmTqtud9G/sms1zVzzaul47mfT1tNgFZPznO3p81mUdRbcCd6PtboYtRfKzaP+krb8lzdpm6LvgzUrTqse7O4Fmc2mfvjYbn1OGmyvKxtlrb2ROnLyo8s83TaRrE5VZwRy33L9lfwo3ROzBtHaLXYpT9+nCP1iTCv3A5DdzM72OE0I86wvuwcfNsY+UltNmUVPvI3av956Z7S3NP54Ymu7GywVw3STbDupuUaaXcXxJ+6yqxd3TMj7wbT1nZqW50Ojiaro8L6ae04OpydbTTI8/1zSelZfVQuj/i5MlCWXq3XXKPuVq9WpudSL6qb+/HQeErMI1DoJ1BLAQIUAAoAAAAIAOyDOFPh0ixX+QMAAFoHAAAQAAAAAAAAAAAAAAAAAAAAAABjZXJ0aWZpY2F0ZS5qc29uUEsFBgAAAAABAAEAPgAAACcEAAAAAA=="
        val verified = DivocVerifier(registry).unpackAndVerify(qr1)

        assertNotNull(verified)
        assertEquals(QRDecoder.Status.VERIFIED, verified.status)
    }


}