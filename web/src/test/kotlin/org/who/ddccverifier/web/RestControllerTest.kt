package org.who.ddccverifier.web

import org.junit.jupiter.api.Assertions.assertEquals
import org.junit.jupiter.api.Test
import org.springframework.boot.test.context.SpringBootTest
import org.who.ddccverifier.verify.QRDecoder

@SpringBootTest
class RestControllerTest {
	@Test
	fun testVerifingDIVOC() {
		var qrProcessor = RestController()
		val qr = "B64:UEsDBAoAAAAIAMVV7lSY3kB9NwMAAA0GAAAQAAAAY2VydGlmaWNhdGUuanNvbrVU2XLiOBT9FZefWbwGm5ces4Q2IZgGO9vUVJcsyaDE2LQkQ0iq/32uTFgy09XzNFU8oKtzj450ju+7/gcuC0lfpd79U19JuRHddnu327V2dqvky7ZlmF4bc0poIRnKRXtr6o1PwA0lVc5yVpCqWLIWI5/hCGNWIMnKor219L8autxvqDrsjnKWMZTmtH/CA/WMl2UWZXfnvottaD+TL6r0mWIQ/v7Bqc8oF2UBJIzAijDSBVVlQQVDXdvsOIZnuobreYZhOIDiNAsV8MrAHUrMlFB0lTrY9h3qdTy7A5ACrWviIJkkC+0+XEwTLRiE8WOg9YLFfTSPALSkBaEcYE1YoKVqsJ26WclHOZN7KIVHKQpECKdCKOlCckplcCzog2Q+nGpxOAq0eaz5DW1+r5kN7WY4aWnnPVXot7RZMO1H82Da0MbBTTCPA20xnARxMIUzPhFbwAw1wqDK1JvVWvFB2VnQnC5B8fEmh1q/rArJ9x/FTSkkyvsloXXhJ3CWKfw1fc9rGm7TdFWNCVHVL/L7oOgHJCowHSCpGC3DsppGp2k6sWl0Hbfrui3fdp8ASbcMjMcqO+86plxCejB01Ra6tul4HcdXz34K2DlCKjgpknilrHENy/AGADxkUx3bj+7CQdP0tUMP1WYZe4MLNPQ1KqoMYVnxk8PkUqoNl44No1v/WhCsWmqWQTDZli4k4vIT9nI3gRjn/9wlpQB2G65RwkMPYCXq5bb+XJSI92Mq6+cHceyQsFN9VokXKtZIaLfwpdBi+fvE/S9ZCQfTX6RF6aWUpAi/JDz/z3x8ubSVYWKaH1SKmpeb1T5Hr6y+w09wuCiLmKNCZJSrsQJlySt6wJbZxZwYEst1TX/BlhAPcFYNOb0eLWAt+XUMla8HD3AdqVsqV+W/xszxsFnFN7WROhJCZfXU0NCfd0ox3Y9X6QiziI2vn4bz+NsiFOE6tKb98OppfS2wlcB6ukcP31iUC/b4/GiEuem3WihKN0GwypfX3vdJPMKvD2+LH+Mf+a3XT5MR6o3sez/K37zY2OZOYO/95CY2+0mSPIXjvPfy8LoZfXXcr5PCfVvecuKset9lLwBz/gZQSwECFAAKAAAACADFVe5UmN5AfTcDAAANBgAAEAAAAAAAAAAAAAAAAAAAAAAAY2VydGlmaWNhdGUuanNvblBLBQYAAAAAAQABAD4AAABlAwAAAAA="

		assertEquals(QRDecoder.Status.VERIFIED, qrProcessor.verify(RestController.QRContents(qr)).status)
	}

	@Test
	fun testVerifingHCert() {
		var qrProcessor = RestController()
		val qr =
			"HC1:6BF6W1SX77XS%20KHH3QH0 8KQLRM86427%NFPT*N2ZNC1R6A-LGN84TEZPF5DQPL9V:JNJMQ82$ OJU3%2SUXT Y1I-0Z+GC:UW+12YE3L3PE7E8TK5MNBPGEVQR3J:DDJL:/SQ0V9L7U6IS2MQF9-Q16UG\$QVW6C8AK9FHVUD%RNM3G9\$EERHCVAY0QZJ8ZEA1UG4GFJ LIG4ABGKMKE1TO58NP8G50IAIF8D55RXOQNYH4ZD4YQZZIFF6+9B-DBUFGW/B S3K-OQ+11YMCE42998UII7CICK 8M398XQNWBT5DB5 C0P8 :NZ372DB3UGYVH7KSI-RKYLUNH43DL*2YR5+-DVNAFKGW+13%R+POHWBB42B:2M59YNR0B0%VODGQ+SGF1M* AUKKKSI6G43QBA/O+GH1 2Z%M200.D1%+QWZ14HC*MT6.KC8M%2LKDVV*NS*SM$8*NQ/MCYRC70CV\$BWQL%V28NJEYUG*N7PGQGDS+F0:BH2GS0BEXBEA6+/GZYQPK2B2AQWNYNPZ*N8DSK/V%LFS8VIDSM*36EV JSO0T%5FCGW9US8BQV\$VH QE2GZ%U75EEJH"

		assertEquals(QRDecoder.Status.VERIFIED, qrProcessor.verify(RestController.QRContents(qr)).status)
	}

}
